{#include layouts/main}
{#title}Nowa ankieta{/title}
{#body}
<form id="survey-form">
    <label for="name">Nazwa ankiety: </label>
    <input type="text" id="name" name="name" value="{survey.name ?: ''}" />

    <div id="events-container">
        {#each survey.events}
        <div class="event-entry">
            <label>Wybierz wydarzenie:</label>
            <select name="events[{it_index}]" onchange="checkDuplicateEvents(this)" required>
                <option value="">-- wybierz --</option>
                {#for event in availableEvents}
                <option value="{event.id}" selected={event.id == it.id}>{event.name}</option>
                {/for}
            </select>
            <button type="button" onclick="removeEvent(this)">Usuń wydarzenie</button>
        </div>
        {/each}
    </div>

    <button type="button" onclick="addEvent()">Dodaj wydarzenie</button>
    <button type="submit">Zapisz ankietę</button>
</form>

<p><a href="/web/surveys">Zobacz listę zapytań</a></p>
<script>
    const availableEventsJson = {availableEventsJson.raw()};
</script>

<script src="/js/script_events.js"></script>

{/body}
{/include}
