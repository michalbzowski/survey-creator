{#include layouts/main}
{#title}{survey.name}{/title}
{#body}

{#each survey.events}
<p>{it.name}</p>
{/each}

<h3>Przypisane osoby</h3>
{#if links.isEmpty()}
<p>Brak przypisanych osób.</p>
<form action="/api/v1/links/{survey.id}" method="get" style="display:inline;">
    <button type="submit" onclick="return confirm('Wygenerować linki dla tego zapytania?')">Generuj linki
    </button>
</form>
{#else}
<table>
    <thead>
    <tr>
        <th>Imię</th>
        <th>Nazwisko</th>
        <th>Email</th>
        <th>Link</th>
        <th>Email</th>
        <th>Odpowiedź</th>
    </tr>
    </thead>
    <tbody>
    {#for link in links}
    <tr>
        <td>{link.personFirstName}</td>
        <td>{link.personLastName}</td>
        <td>{link.personEmail}</td>
        <td><a href="/web/responses/{link.linkToken}" target="_blank">Otwórz</a></td>

        <td style="text-align: center;">
            {#if link.status.name() eq "TO_SEND"}
            <form id="send-email-button" action="/api/v1/links/{survey.id}/email/{link.personId}" method="post" style="display:inline;">
                <button type="submit">Wyślij</button>
            </form>
            {#else}
            <i class="si-check-circle"></i>
            {/if}
        </td>
        <td style="text-align: center;">
            {#if link.surveyAnswered}
            <i class="si-check-circle"></i>
            {#else}
            <i class="si-ban"></i>
            {/if}
        </td>
    </tr>
    {/for}
    </tbody>
</table>
{/if}
<p><a href="/web/surveys">← Powrót do listy zapytań</a></p>
{/body}
{/include}
